% 기초 컴퓨터 그래픽스 - 프로그래밍 숙제 3
% 2019년 5월 20일
% 서강대학교 국어국문학전공 20120085 엄태경

# OpenGL API 함수를 사용한 3D 뷰잉 연습

## 요구 기능 구현 내용

### (a) 물체의 배치 및 움직임 구현

#### i. 움직이는 호랑이

<!-- TODO: 일정 거리를 달리다가

TODO: 점프 (포물선 구현)

TODO: 방향 변환 -->

#### ii. 계층적 모델링 방식의 자동차 (구현 완료)

##### 자동차의 이동 (구현 완료)

자동차는 세상좌표계에서 다음 식에 따라 원점을 중심으로 나비 모양을 그리며 이동한다. `[1]`

$$
\left\{
\begin{aligned}
x &= \sin(t) \left(e^{\cos(t)} - 2\cos(4t) - \sin^5\left({t \over 12}\right)\right) \\
y &= 0 \\
z &= \cos(t) \left(e^{\cos(t)} - 2\cos(4t) - \sin^5\left({t \over 12}\right)\right)
\end{aligned}
\right .
$$

이는 `xz` 평면상에서 다음과 같은 궤적을 그린다.

![xz 평면 상에서 자동차 중심의 궤적](img/butterfly.png){width=40%}

파라미터를 입력받아 좌표를 반환하는 함수는 `custommath.hpp`에 `glm::vec3 getButterflyCurve(float)`으로 정의되어 있다.

##### 바퀴의 좌우 회전 (구현 완료)

차량의 회전에 따라 바퀴가 자연스럽게 움직이기 위해서는 다양한 모델을 이용할 수 있는데, 본 프로젝트에서는 아커만 조향 모델(Ackermann Steering Model)을 따른다. 간략한 도식은 아래와 같다. `[2]`

![아커만 조향 모델에 따른 바퀴의 좌우 회전](img/ackermann.png){width=40%}

이를 이용하기 위해서는 차량이 이동하는 궤적의 접원의 중심을 알아야 한다. 그런데 위의 복잡한 곡선 식으로부터 정확한 접원을 계산하려면 매우 복잡한 연산이 필요하다. 따라서 본 프로젝트에서는 `<자동차의 직전 위치, 자동차의 현재 위치, 자동차의 다음 위치>`의 세 점이 그리는 삼각형의 외접원을 접원의 근사값으로 이용한다. 외접원을 구하는 함수는 `custommath.hpp`에 `glm::vec3 getCircumcenter(const glm::vec3 &, const glm::vec3 &, const glm::vec3 &)`으로, 이를 이용해 바퀴의 좌우 회전 각도를 구하는 함수는 `glm::vec2 getSteeringAngle(const glm::vec3 &)`으로 정의되어 있다.

##### 바퀴의 구름 (구현 완료)

바퀴가 굴러가는 것을 자연스럽게 표현하려면, 매 프레임마다 자동차가 이동한 거리만큼 바퀴가 회전해야 한다. 위 곡선의 호를 정확히 계산하는 것은 매우 복잡한 연산을 요구하므로, 본 프로젝트에서는 `자동차의 현재 위치`와 `자동차의 직전 위치` 사이의 거리를 근사값으로 이용한다. 이 거리와 바퀴의 반지름을 이용해 바퀴가 굴러야 하는 각도를 계산하여 매 프레임마다 그만큼 바퀴를 회전시킨다.

#### iii. 추가 3D 모델 배치

<!-- TODO: 다섯개를 배치 -->

#### iv. 키보드와 마우스를 이용한 조작

<!-- TODO: 세 개를 키보드와 마우스로 조작 -->

### (b) 카메라의 배치 및 움직임 구현

#### i. 주카메라

##### A. 주 카메라 배치 (구현 완료)

(75, 75, 100)에서 y축 방향을 위쪽으로 하여 원점을 바라보도록 설정하였다.

##### B. 카메라 줌 (구현 완료)

SHIFT를 누른 상태에서 마우스가 왼쪽/오른쪽으로 1 이동할 때마다 카메라의 y축 시야각이 0.05도 감소/증가하면서 줌 효과를 구현한다. 단, 0도보다 작거나 180도보다 큰 시야각은 불가능하다.

FreeGLUT 라이브러리의 한계로 SHIFT 키가 눌린 여부를 확인하려면 키보드 또는 마우스 입력이 필요하다. 따라서 마우스 왼쪽 버튼 이미 누른 상태에서 SHIFT를 누르거나 떼면 동작에 변화가 없다. 오직 SHIFT를 먼저 누르고 마우스 왼쪽 버튼을 누르고 좌우로 이동할 때에만 줌 효과가 발생한다.

##### C. 카메라 회전

<!-- TODO: 구면좌표계에서 식 유도 -->

#### ii. 부 카메라

##### A. 부윈도우 토글

<!-- TODO: 부윈도우가 뭐여 시벌 -->

##### B. 부윈도우 이동

<!-- TODO: 마우스 또는 키보드를 이용하여 부윈도우 조작 -->

##### C. 부윈도우 회전

<!-- TODO: 마우스 또는 키보드를 이용하여 좌우 회전 -->

##### D. 부윈도우 줌

<!-- TODO: 마우스 또는 키보드를 이용하여 부윈도우 줌 -->

### iii. 운전석 카메라

<!-- TODO: 운전석에서 바라본 세상 -->

### iv. 호랑이 카메라

<!-- TODO: 호랑이 눈에서 바라본 세상 -->

## 미주

---
<!--markdownlint-disable MD034 -->
[1] 나비모양 곡선에 관한 정보는 다음 링크에서 참조하였다. http://mathworld.wolfram.com/ButterflyCurve.html

[2] 아커만 조향 모델에 관한 정보는 다음 링크에서 참조하였다. http://datagenetics.com/blog/december12016/index.html